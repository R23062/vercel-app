{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/vercel-app/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { createBrowserClient } from \"@supabase/ssr\";\n\nexport default function Home() {\n  // ブラウザ用クライアントの作成\n  const supabase = createBrowserClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n  );\n\n  const [posts, setPosts] = useState<any[]>([]);\n  const [content, setContent] = useState(\"\");\n\n  // 1. 投稿を取得する関数\n  const fetchPosts = async () => {\n    const { data, error } = await supabase\n      .from(\"posts\")\n      .select(\"*\")\n      .order(\"created_at\", { ascending: false });\n    \n    if (error) {\n      console.error(\"Error fetching posts:\", error);\n    } else {\n      setPosts(data || []);\n    }\n  };\n\n  useEffect(() => {\n    fetchPosts();\n\n    // 2. リアルタイム更新の設定\n    const channel = supabase\n      .channel(\"realtime-posts\")\n      .on(\n        \"postgres_changes\",\n        { event: \"INSERT\", schema: \"public\", table: \"posts\" },\n        () => fetchPosts()\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, []);\n\n  // 3. 投稿を送信する関数\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!content.trim()) return;\n\n    const { error } = await supabase\n      .from(\"posts\")\n      .insert([{ content, username: \"匿名ユーザー\" }]);\n    \n    if (error) {\n      alert(\"投稿に失敗しました: \" + error.message);\n    } else {\n      setContent(\"\");\n      // INSERTイベントが飛んでくるので、fetchPostsは自動で呼ばれます\n    }\n  };\n\n  return (\n    <main className=\"max-w-2xl mx-auto p-4 font-sans\">\n      <header className=\"py-6 border-b mb-8\">\n        <h1 className=\"text-3xl font-extrabold text-blue-600\">Mini X (掲示板)</h1>\n      </header>\n      \n      {/* 投稿フォーム */}\n      <form onSubmit={handleSubmit} className=\"mb-8 bg-gray-50 p-4 rounded-lg shadow-sm\">\n        <textarea\n          className=\"w-full p-3 border border-gray-300 rounded-md text-black focus:ring-2 focus:ring-blue-500 focus:outline-none\"\n          rows={3}\n          placeholder=\"いまどうしてる？\"\n          value={content}\n          onChange={(e) => setContent(e.target.value)}\n        />\n        <div className=\"flex justify-end mt-2\">\n          <button\n            type=\"submit\"\n            className=\"px-6 py-2 bg-blue-500 text-white font-bold rounded-full hover:bg-blue-600 transition\"\n          >\n            ポストする\n          </button>\n        </div>\n      </form>\n\n      {/* 投稿一覧 */}\n      <div className=\"space-y-6\">\n        {posts.map((post) => (\n          <div key={post.id} className=\"p-4 border border-gray-100 rounded-xl hover:bg-gray-50 transition\">\n            <div className=\"flex items-center space-x-2 mb-2\">\n              <span className=\"font-bold text-gray-800\">{post.username}</span>\n              <span className=\"text-xs text-gray-400\">\n                {new Date(post.created_at).toLocaleString('ja-JP')}\n              </span>\n            </div>\n            <p className=\"text-gray-700 whitespace-pre-wrap\">{post.content}</p>\n          </div>\n        ))}\n      </div>\n    </main>\n  );\n}"],"names":[],"mappings":";;;;AAQI;;AANJ;AACA;AAAA;;;AAHA;;;AAKe,SAAS;;IACtB,iBAAiB;IACjB,MAAM,WAAW,IAAA,oMAAmB;IAKpC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,eAAe;IACf,MAAM,aAAa;QACjB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,SACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,yBAAyB;QACzC,OAAO;YACL,SAAS,QAAQ,EAAE;QACrB;IACF;IAEA,IAAA,0KAAS;0BAAC;YACR;YAEA,iBAAiB;YACjB,MAAM,UAAU,SACb,OAAO,CAAC,kBACR,EAAE,CACD,oBACA;gBAAE,OAAO;gBAAU,QAAQ;gBAAU,OAAO;YAAQ;0CACpD,IAAM;yCAEP,SAAS;YAEZ;kCAAO;oBACL,SAAS,aAAa,CAAC;gBACzB;;QACF;yBAAG,EAAE;IAEL,eAAe;IACf,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,IAAI,CAAC,QAAQ,IAAI,IAAI;QAErB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,SACL,MAAM,CAAC;YAAC;gBAAE;gBAAS,UAAU;YAAS;SAAE;QAE3C,IAAI,OAAO;YACT,MAAM,gBAAgB,MAAM,OAAO;QACrC,OAAO;YACL,WAAW;QACX,yCAAyC;QAC3C;IACF;IAEA,qBACE,6LAAC;QAAK,WAAU;;0BACd,6LAAC;gBAAO,WAAU;0BAChB,cAAA,6LAAC;oBAAG,WAAU;8BAAwC;;;;;;;;;;;0BAIxD,6LAAC;gBAAK,UAAU;gBAAc,WAAU;;kCACtC,6LAAC;wBACC,WAAU;wBACV,MAAM;wBACN,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;;;;;;kCAE5C,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BACC,MAAK;4BACL,WAAU;sCACX;;;;;;;;;;;;;;;;;0BAOL,6LAAC;gBAAI,WAAU;0BACZ,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC;wBAAkB,WAAU;;0CAC3B,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAK,WAAU;kDAA2B,KAAK,QAAQ;;;;;;kDACxD,6LAAC;wCAAK,WAAU;kDACb,IAAI,KAAK,KAAK,UAAU,EAAE,cAAc,CAAC;;;;;;;;;;;;0CAG9C,6LAAC;gCAAE,WAAU;0CAAqC,KAAK,OAAO;;;;;;;uBAPtD,KAAK,EAAE;;;;;;;;;;;;;;;;AAa3B;GApGwB;KAAA"}}]
}